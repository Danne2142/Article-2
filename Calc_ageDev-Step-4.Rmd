---
title: "Calc_ageDev"
output: html_document
date: "2024-10-29"
---

### Import data and functions
```{r}
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/remove_other().R")
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/logical_to_numeric().R")
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/convert_to_factors().R")
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/convert_yes_no_to_logical().R")
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/convert_to_binary().R")
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/char_cols_to_factors().R")
# 
source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/calc_AgeDev().R")
source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/count_outliers().R")
source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/get_Numeric_and_int_cols().R")
source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/plot_with_std_outliers().R")
source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/replace_zero_negatives().R")
source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/count_zero_and_negatives().R")
# source("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Program/replace_zero_negatives().R")


load("C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Output/data_after_step3")
# Rename dataframe in this new script
data<-data_with_outliers_removed
rm(data_with_outliers_removed) # Remove old dataframe
```



### Calculate AgeDev
```{r}
data_with_ageDev<-data
biological_age_markers <- c("Hannum.PC","Horvath.PC",
                  "GrimAge.PC","PhenoAge.PC","OMICmAge","SystemsAge.Blood","SystemsAge.Brain","SystemsAge.Inflammation",
                  "SystemsAge.Heart","SystemsAge.Hormone","SystemsAge.Immune","SystemsAge.Kidney","SystemsAge.Liver","SystemsAge.Metabolic",
                  "SystemsAge.Lung","SystemsAge.MusculoSkeletal","SystemsAge")
for (variable in biological_age_markers) {
data_with_ageDev<- calc_AgeDev(data_with_ageDev, variable)
}

```

### Plot variables
```{r}
col_numbers<- get_Numeric_and_int_cols(data_with_ageDev, exclude_cols= c("Patient.ID", "PID", "survey_version", "Array", "Collection.Date", "Decimal.Chronological.Age", "Hannum.PC", "Horvath.PC",
  "Telomere.Values.PC", "GrimAge.PC", "PhenoAge.PC", "SystemsAge.Blood",
  "SystemsAge.Brain", "SystemsAge.Inflammation", "SystemsAge.Heart",
  "SystemsAge.Hormone", "SystemsAge.Immune", "SystemsAge.Kidney",
  "SystemsAge.Liver", "SystemsAge.Metabolic", "SystemsAge.Lung",
  "SystemsAge.MusculoSkeletal", "SystemsAge", "OMICmAge", "DunedinPACE"))

for (i in col_numbers) {

  plot_with_std_outliers(data_with_ageDev, outliers_std_thresh = 5, col_num = i)

}

```


### Save data
```{r}
save(data_with_ageDev, file = "C:/Users/danwik/OneDrive - Karolinska Institutet/Documents/Project 2 - Vscode/Output/data_after_step4")

```

